<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="SQL," />










<meta name="description" content="2020-04-14 SQL PracticeQ1:The ReportQuestion有两张表: Students 和 Grades*。 *Students 包含三个字段ID, Name 和 Marks。    Column Type    ID Integer   Name String   Marks Integer   Grades 包含如下数据：    Grade Min_Mark Ma">
<meta property="og:type" content="article">
<meta property="og:title" content="2020-04-14 SQL Practice">
<meta property="og:url" content="http://yoursite.com/2020/04/14/2020-04-14-SQL-Practice/index.html">
<meta property="og:site_name" content="瀛涯胜览">
<meta property="og:description" content="2020-04-14 SQL PracticeQ1:The ReportQuestion有两张表: Students 和 Grades*。 *Students 包含三个字段ID, Name 和 Marks。    Column Type    ID Integer   Name String   Marks Integer   Grades 包含如下数据：    Grade Min_Mark Ma">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-14T07:03:09.000Z">
<meta property="article:modified_time" content="2020-04-14T18:31:07.881Z">
<meta property="article:author" content="Ars Magna   &quot;El Gran Arte&quot;">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/04/14/2020-04-14-SQL-Practice/"/>





  <title>2020-04-14 SQL Practice | 瀛涯胜览</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">瀛涯胜览</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/14/2020-04-14-SQL-Practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ars Magna   "El Gran Arte"">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/b4f5abcb-6eee-4a3d-bcad-c11552df1c95/d1ftwtp-cae914ca-8e0c-41d2-b0b5-32fe61b2f8e7.jpg/v1/fill/w_605,h_750,q_75,strp/seiya_by_spaceweaver_d1ftwtp-fullview.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzUwIiwicGF0aCI6IlwvZlwvYjRmNWFiY2ItNmVlZS00YTNkLWJjYWQtYzExNTUyZGYxYzk1XC9kMWZ0d3RwLWNhZTkxNGNhLThlMGMtNDFkMi1iMGI1LTMyZmU2MWIyZjhlNy5qcGciLCJ3aWR0aCI6Ijw9NjA1In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.87g460Y4Wh4VkwKufRjEnKdegA9_7KR6i26k4aYkGQ0">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瀛涯胜览">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2020-04-14 SQL Practice</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-14T00:03:09-07:00">
                2020-04-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="2020-04-14-SQL-Practice"><a href="#2020-04-14-SQL-Practice" class="headerlink" title="2020-04-14 SQL Practice"></a>2020-04-14 SQL Practice</h1><h2 id="Q1-The-Report"><a href="#Q1-The-Report" class="headerlink" title="Q1:The Report"></a>Q1:The Report</h2><h3 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h3><p>有两张表: <em>Students</em> 和 <em>Grades*。 *Students</em> 包含三个字段<em>ID</em>, <em>Name</em> 和 <em>Marks</em>。</p>
<table>
<thead>
<tr>
<th align="left">Column</th>
<th align="left">Type</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ID</td>
<td align="left">Integer</td>
</tr>
<tr>
<td align="left">Name</td>
<td align="left">String</td>
</tr>
<tr>
<td align="left">Marks</td>
<td align="left">Integer</td>
</tr>
</tbody></table>
<p><em>Grades</em> 包含如下数据：</p>
<table>
<thead>
<tr>
<th align="left">Grade</th>
<th align="left">Min_Mark</th>
<th align="left">Max_Mark</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">10</td>
<td align="left">19</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">20</td>
<td align="left">29</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">30</td>
<td align="left">39</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">40</td>
<td align="left">49</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">50</td>
<td align="left">59</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">60</td>
<td align="left">69</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">70</td>
<td align="left">79</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">80</td>
<td align="left">89</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">90</td>
<td align="left">100</td>
</tr>
</tbody></table>
<p><em>Ketty</em> 给 <em>Eve</em> 一个任务，去生成包含三个字段的报告：<em>Name</em>, <em>Grade</em> 和 <em>Mark*。 *Ketty</em> 不想要8级以下学生的姓名。报告必须根据等级降序排序，等级高的优先。如果等级相同，姓名按字母表顺序排序。最后，如果等级低于8，用“NULL”替代姓名，并按等级降序排序。对于等级小于8的学生，如果等级相同，按照分数排序。</p>
<p>写一条查询语句来帮助Eve。</p>
<a id="more"></a>

<p><strong>输入样例</strong></p>
<table>
<thead>
<tr>
<th align="left">ID</th>
<th align="left">Name</th>
<th align="left">Marks</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">Julia</td>
<td align="left">88</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Samantha</td>
<td align="left">68</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Maria</td>
<td align="left">99</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Scarlet</td>
<td align="left">78</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">Ashley</td>
<td align="left">63</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">Jane</td>
<td align="left">81</td>
</tr>
</tbody></table>
<p><strong>输出样例</strong></p>
<blockquote>
<p>Maria 10 99<br>Jane 9 81<br>Julia 9 88<br>Scarlet 8 78<br>NULL 7 63<br>NULL 7 68</p>
</blockquote>
<p><strong>注意</strong></p>
<p>如果等级低于8，打印“NULL”作为姓名。</p>
<p><strong>说明</strong></p>
<p>把学生成绩的等级对应之后的表格如下：</p>
<table>
<thead>
<tr>
<th align="left">ID</th>
<th align="left">Name</th>
<th align="left">Marks</th>
<th align="left">Grade</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">Julia</td>
<td align="left">88</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Samantha</td>
<td align="left">68</td>
<td align="left">7</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Maria</td>
<td align="left">99</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Scarlet</td>
<td align="left">78</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">Ashley</td>
<td align="left">63</td>
<td align="left">7</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">Jane</td>
<td align="left">81</td>
<td align="left">9</td>
</tr>
</tbody></table>
<p>所以，下列学生的等级为8，9，10:</p>
<ul>
<li><em>Maria (等级 10)</em></li>
<li><em>Jane (等级 9)</em></li>
<li><em>Julia (等级 9)</em></li>
<li><em>Scarlet (等级 8)</em></li>
</ul>
<h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>首先，join 两张表是必须要做的操作。</p>
<p>在这里发现了一个新的join方法，两个表不再是用key的match做join，而是以某个表的key在区间内作为join的条件：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ID</span>, <span class="keyword">Name</span>, Marks, Grade <span class="keyword">FROM</span> Students <span class="keyword">AS</span> s <span class="keyword">JOIN</span> Grades <span class="keyword">AS</span> g <span class="keyword">ON</span> s.Marks <span class="keyword">BETWEEN</span> g.Min_Mark <span class="keyword">AND</span> g.Max_Mark;</span><br></pre></td></tr></table></figure>



<p>得到的表如下：</p>
<table>
<thead>
<tr>
<th align="left">ID</th>
<th align="left">Name</th>
<th align="left">Marks</th>
<th align="left">Grade</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">Julia</td>
<td align="left">88</td>
<td align="left">9</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Samantha</td>
<td align="left">68</td>
<td align="left">7</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Maria</td>
<td align="left">99</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Scarlet</td>
<td align="left">78</td>
<td align="left">8</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">Ashley</td>
<td align="left">63</td>
<td align="left">7</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">Jane</td>
<td align="left">81</td>
<td align="left">9</td>
</tr>
</tbody></table>
<p>同时，题目要求输出姓名，等级，分数，所以得把这些变量给query出来：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.Name, g.Grade, s.Marks <span class="keyword">FROM</span> Students <span class="keyword">AS</span> s <span class="keyword">JOIN</span> Grades <span class="keyword">AS</span> g <span class="keyword">ON</span> s.Marks <span class="keyword">BETWEEN</span> g.Min_Mark <span class="keyword">AND</span> g.Max_Mark;</span><br></pre></td></tr></table></figure>



<p>因为只需要显示等第&gt;8 的学生姓名，所以我们使用<code>IF()</code>函数作为筛选。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">IF</span>(g.Grade&lt;<span class="number">8</span>, <span class="literal">NULL</span>, s.Name), g.Grade, s.Marks <span class="keyword">FROM</span> Students <span class="keyword">AS</span> s <span class="keyword">JOIN</span> Grades <span class="keyword">AS</span> g <span class="keyword">ON</span> s.Marks <span class="keyword">BETWEEN</span> g.Min_Mark <span class="keyword">AND</span> g.Max_Mark;</span><br></pre></td></tr></table></figure>



<p>最后就是排序。先根据等级降序排序。对于等级相同的学生，根据姓名按字母表顺序排序。由于等级小于8的学生都用“NULL”替代姓名，所以如果等级小于8的学生等级相同的话，再根据分数排序：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">IF</span>(g.Grade&lt;<span class="number">8</span>, <span class="literal">NULL</span>, s.Name), g.Grade, s.Marks <span class="keyword">FROM</span> Students <span class="keyword">AS</span> s <span class="keyword">JOIN</span> Grades <span class="keyword">AS</span> g <span class="keyword">ON</span> s.Marks <span class="keyword">BETWEEN</span> g.Min_Mark <span class="keyword">AND</span> g.Max_Mark <span class="keyword">ORDER</span> <span class="keyword">BY</span> g.Grade <span class="keyword">DESC</span>, s.Name, s.Marks;</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="解法："><a href="#解法：" class="headerlink" title="解法："></a>解法：</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">IF</span>(g.Grade&lt;<span class="number">8</span>, <span class="literal">NULL</span>, s.Name), g.Grade, s.Marks <span class="keyword">FROM</span> Students <span class="keyword">AS</span> s <span class="keyword">JOIN</span> Grades <span class="keyword">AS</span> g <span class="keyword">ON</span> s.Marks <span class="keyword">BETWEEN</span> g.Min_Mark <span class="keyword">AND</span> g.Max_Mark <span class="keyword">ORDER</span> <span class="keyword">BY</span> g.Grade <span class="keyword">DESC</span>, s.Name, s.Marks;</span><br></pre></td></tr></table></figure>

<h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><h2 id="Q2-Projects"><a href="#Q2-Projects" class="headerlink" title="Q2:Projects"></a>Q2:Projects</h2><h3 id="Question-1"><a href="#Question-1" class="headerlink" title="Question:"></a>Question:</h3><p>You are given a table, <em>Projects</em>, containing three columns: <em>Task_ID</em>, <em>Start_Date</em> and <em>End_Date</em>. It is guaranteed that the difference between the <em>End_Date</em> and the <em>Start_Date</em> is equal to 1 day for each row in the table.</p>
<p>If the <em>End_Date</em> of the tasks are consecutive, then they are part of the same project. Samantha is interested in finding the total number of different projects completed.</p>
<p>Write a query to output the start and end dates of projects listed by the number of days it took to complete the project in ascending order. If there is more than one project that have the same number of completion days, then order by the start date of the project.</p>
<h3 id="Analysis-1"><a href="#Analysis-1" class="headerlink" title="Analysis"></a>Analysis</h3><p>This part cited the blogs of Fan Ni:</p>
<blockquote>
<p>For this problem, we can find start date and end date of each project and then order by duration and start date. To find start date and end date of projects, we can get start date and end date of each project separately first, then cross join start and end dates and find (start date, end date) pairs based on some conditions. That is basic ideas of my solution.</p>
<p>First, we need to find start dates and end dates of each project separately. If a start date is not included in all end dates, it should be the start date of a project:</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> Start_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Similarly, an end date excluded in start date column should be the end date of some project:</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> End_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Then, we need to find (start date, end date) pairs for each project. Before that, we can cross join start dates and end dates of projects to generate all potential pairs. Also, for the same project, end date should be the minimum among all end dates of projects that are larger than start date of the project:</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Start_Date, <span class="keyword">MIN</span>(End_Date) <span class="keyword">FROM</span></span><br><span class="line">(<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> Start_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> s,</span><br><span class="line">(<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> End_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> e</span><br><span class="line"><span class="keyword">WHERE</span> Start_Date &lt; End_Date</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Start_Date;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Finally, sort output by duration and start date:</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Start_Date, <span class="keyword">MIN</span>(End_Date) <span class="keyword">FROM</span></span><br><span class="line">(<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> Start_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> s,</span><br><span class="line">(<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> End_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> e</span><br><span class="line"><span class="keyword">WHERE</span> Start_Date &lt; End_Date</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Start_Date</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">DATEDIFF</span>(<span class="keyword">MIN</span>(End_Date), Start_Date), Start_Date;</span><br></pre></td></tr></table></figure>

<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><hr>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Start_Date, <span class="keyword">MIN</span>(End_Date) <span class="keyword">FROM</span></span><br><span class="line">(<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> Start_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> s,</span><br><span class="line">(<span class="keyword">SELECT</span> End_Date <span class="keyword">FROM</span> Projects <span class="keyword">WHERE</span> End_Date <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Start_Date <span class="keyword">FROM</span> Projects)) <span class="keyword">AS</span> e</span><br><span class="line"><span class="keyword">WHERE</span> Start_Date &lt; End_Date</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Start_Date</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">DATEDIFF</span>(<span class="keyword">MIN</span>(End_Date), Start_Date), Start_Date;</span><br></pre></td></tr></table></figure>



<hr>
<p><a href="https://nifannn.github.io/2017/10/24/SQL-Notes-Hackerrank-Projects/" target="_blank" rel="noopener">https://nifannn.github.io/2017/10/24/SQL-Notes-Hackerrank-Projects/</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/SQL/" rel="tag"># SQL</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/04/07/2020-04-07-Hackerank-SQL-practice/" rel="next" title="2020-04-07 Hackerank SQL practice">
                <i class="fa fa-chevron-left"></i> 2020-04-07 Hackerank SQL practice
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/04/14/2020-04-15-SQL-Practice/" rel="prev" title="2020-04-14 SQL Practice（Part 2）">
                2020-04-14 SQL Practice（Part 2） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/b4f5abcb-6eee-4a3d-bcad-c11552df1c95/d1ftwtp-cae914ca-8e0c-41d2-b0b5-32fe61b2f8e7.jpg/v1/fill/w_605,h_750,q_75,strp/seiya_by_spaceweaver_d1ftwtp-fullview.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzUwIiwicGF0aCI6IlwvZlwvYjRmNWFiY2ItNmVlZS00YTNkLWJjYWQtYzExNTUyZGYxYzk1XC9kMWZ0d3RwLWNhZTkxNGNhLThlMGMtNDFkMi1iMGI1LTMyZmU2MWIyZjhlNy5qcGciLCJ3aWR0aCI6Ijw9NjA1In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.87g460Y4Wh4VkwKufRjEnKdegA9_7KR6i26k4aYkGQ0"
                alt="Ars Magna   "El Gran Arte"" />
            
              <p class="site-author-name" itemprop="name">Ars Magna   "El Gran Arte"</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Ars-Magna99" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-04-14-SQL-Practice"><span class="nav-number">1.</span> <span class="nav-text">2020-04-14 SQL Practice</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q1-The-Report"><span class="nav-number">1.1.</span> <span class="nav-text">Q1:The Report</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Question"><span class="nav-number">1.1.1.</span> <span class="nav-text">Question</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Analysis"><span class="nav-number">1.1.2.</span> <span class="nav-text">Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#"><span class="nav-number">1.1.3.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解法："><span class="nav-number">1.1.4.</span> <span class="nav-text">解法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#-1"><span class="nav-number">1.1.5.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q2-Projects"><span class="nav-number">1.2.</span> <span class="nav-text">Q2:Projects</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Question-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">Question:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Analysis-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">Analysis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution"><span class="nav-number">1.2.3.</span> <span class="nav-text">Solution</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ars Magna   "El Gran Arte"</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
